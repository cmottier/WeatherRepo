{
  "hash": "9380fc3e845353a8a7222e667ca16c10",
  "result": {
    "markdown": "---\ntitle: Prévisions météo à Montpellier\nformat:\n  html:\n    code-fold: true\n    theme: cosmo\n    backgroundcolor: 'rgb(178,235,242)'\n---\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport datetime\nimport locale\nimport requests\nimport json\nimport numpy as np\nimport pandas as pd\nfrom IPython.display import display, Markdown\n\n# Récupération des données de météo pour les n prochains jours\n\ndef data(n):\n    debut = datetime.date.today()\n    fin = debut + datetime.timedelta(days = n-1)\n    debut = debut.isoformat()\n    fin = fin.isoformat()\n    url = \"https://api.open-meteo.com/v1/meteofrance?latitude=43.6109&longitude=3.8763&hourly=windspeed_10m&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_sum,windspeed_10m_max&timezone=Europe%2FBerlin&start_date=\" + debut + \"&end_date=\" + fin\n    reponse = requests.get(url)\n    return reponse.json()\n\nn = 5\ndata = data(n)\n\nlocale.setlocale(locale.LC_TIME,'')\nDate = pd.to_datetime(data['daily']['time'])\nDate =[datetime.datetime.strftime(a,'%A %d/%m') for a in Date]\n\nweather = data['daily']['weathercode']\n\ntemp_min = data['daily']['temperature_2m_min']\ntemp_max = data['daily']['temperature_2m_max']\n\nprecip = data['daily']['precipitation_sum']\n\n# Calcul du vent moyen à 10m pour les n prochains jours\n\nwind = data['hourly']['windspeed_10m']\n\ndef wind_av(n):\n    wind_av = []\n    for i in range(n):\n        w = np.array(wind[24*i:24*(i+1)])\n        wind_av += [int(w[w!=None].mean())]\n    return wind_av\n\nwind = wind_av(n)\n\n# Correspondances codes météo - images\n\nwith open(\"Correspondances.json\", \"r\") as C:\n    image = json.load(C)\n\n#Construction tableau\n\nD = \"|\".join(Date)\nP = \" mm|\".join([str(precip[i]).replace(\"None\",\"-\") for i in range(n)]) \nWi = \" km/h|\".join(str(i) for i in wind) + \" km/h\"\n\nW = \"\"\nfor i in weather :\n    W += \"![](\" + image[str(i)]['image'] + \")|\"\n\nSep = \"|\"\nT = \"|\"\nfor i in range(n):\n    Sep += f\":---:|\"\n    T += f\"{temp_min[i]}°C - {temp_max[i]}°C|\"\n                                     \nT=(D+\"\\n\"+Sep+\"\\n\"+W+\"\\n\"+T+\"\\n\"+Wi+\"\\n\"+P)\n\ndisplay(Markdown(T))\n```\n\n::: {.cell-output .cell-output-display}\nmercredi 25/10|jeudi 26/10|vendredi 27/10|samedi 28/10|dimanche 29/10\n|:---:|:---:|:---:|:---:|:---:|\n![](http://openweathermap.org/img/wn/03d@2x.png)|![](http://openweathermap.org/img/wn/09d@2x.png)|![](http://openweathermap.org/img/wn/03d@2x.png)|![](http://openweathermap.org/img/wn/09d@2x.png)|![](http://openweathermap.org/img/wn/03d@2x.png)|\n|12.0°C - 20.8°C|15.2°C - 21.8°C|13.0°C - 19.2°C|8.6°C - 18.9°C|13.2°C - 16.5°C|\n8 km/h|8 km/h|16 km/h|11 km/h|12 km/h\n0.0 mm|0.1 mm|0.0 mm|0.2 mm|-\n:::\n:::\n\n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}